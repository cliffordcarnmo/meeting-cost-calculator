<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<title>Meeting cost calculator</title>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">		
		<script>
			class Meeting{
				constructor(){
					this.participants = [];
				}

				startMeeting(){
					this.startTime = new Date();
				}

				addParticipants(role){
					this.participants.push(role);
				}

				clearParticipants(){
					this.participants = [];
				}

				getParticipants(){
					return this.participants;
				}

				getStartTime(){
					return this.startTime;
				}

				getElapsedTime(){
					let diff = new Date() - this.startTime;
					diff /= 1000;
					return Math.round(diff);
				}

				getElapsedCost(){
					return this.getElapsedTime() * this.getMeetingCostPerSecond()
				}

				getMeetingCostPerSecond() {
					var cost = 0;
					for (var i = 0; i < this.participants.length; i++) {
						cost += this.participants[i].getSalaryPerSecond();
					}
					return cost;
				}
			}

			class Role{
				constructor(name, yearlyWage, socialCost){
					this.name = name;
					this.yearlyWage = yearlyWage;
					this.socialCost = socialCost;
				}

				getName(){
					return this.name;
				}

				getYearlyWage(){
					return this.yearlyWage;
				}

				getSalaryPerSecond(){
					return this.yearlyWage / 12 / 20 / 8 / 60 / 60;
				}

				getSocialCost(){
					return this.socialCost;
				}
			}

			let m = new Meeting();

			function startTicker() {
				m.startMeeting();
				setInterval(showMeetingCost, 1000);
			}

			function showMeetingCost(){
				document.getElementById("meetingCost").innerHTML = "â‚¬" + m.getElapsedCost().toFixed(2);
			}

			function itterateTable() {
				m.clearParticipants();
				var table = document.getElementById("roleTable");
				var rows = table.getElementsByClassName("role");
				for (var i = 0; i < rows.length; i++) {
					var roleCount = rows[i].getElementsByClassName('roleCount')[0].innerHTML;
					var roleName = rows[i].getElementsByClassName('roleName')[0].innerHTML;
					var roleCost = rows[i].getElementsByClassName('roleWage')[0].innerHTML;
					var socialCost = parseInt(document.getElementById("socialCost").value);

					for (var j = 0; j < roleCount; j++) {
						m.addParticipants(new Role(roleName, roleCost, socialCost));
					}
				}
			}
			
		</script>
	</head>
	<body>
		<div class="container p-3">
			<div class="row">
				<div class="col">
					<h1 class="display-1">Meeting Cost Calculator</h1>
				</div>
			</div>
			
			<div class="row">
				<div class="col">
					<div id="meetingCost" class="text-danger display-1"></div>
				</div>
			</div>
			
			<div class="row">
				<div class="col-4">
					<label for="socialCost" class="form-label">Average Yearly Wage in EUR</label>
					<input class="form-control" type="text" id="roleWage" value="85229" onkeyup="javascript:itterateTable();">
				</div>
				<div class="col-4">
					<label for="socialCost" class="form-label">Enter the social/state cost of employment</label>
					<input class="form-control" type="text" id="socialCost" value="0.3142">
				</div>
			</div>
			
			<div class="row">
				<div class="col-4">
					<label for="roleName" class="form-label">Participant role</label>
					<input class="form-control" type="text" id="roleName" value="Average IT worker" onkeyup="javascript:itterateTable();">
				</div>
				<div class="col-4">
					<label for="socialCost" class="form-label">Number of participants in this meeting</label>
					<input class="form-control" type="text" id="roleCount" value="0" onkeyup="javascript:itterateTable();">
				</div>
			</div>

			<!--
			<table class="table" id ="roleTable">
				<tr>
				  <th>Name</th>
				  <th>Average Yearly Wage in EUR</th>
				  <th>Number in this meeting</th>
				</tr>
				<tr class="role">
					<td contenteditable="true" class="roleName" onkeyup="javascript:itterateTable();">Average IT Worker</td>
					<td contenteditable="true" class="roleWage" onkeyup="javascript:itterateTable();">85229</td>
					<td contenteditable="true" class="roleCount" onkeyup="javascript:itterateTable();">0</td>
				</tr>
				<tr class="role">
					<td contenteditable="true" class="roleName" onkeyup="javascript:itterateTable();">Software Engineer</td>
					<td contenteditable="true" class="roleWage" onkeyup="javascript:itterateTable();">85229</td>
					<td contenteditable="true" class="roleCount" onkeyup="javascript:itterateTable();">0</td>
				</tr>
				<tr class="role">
				  <td contenteditable="true" class="roleName" onkeyup="javascript:itterateTable();">Scrum Master</td>
				  <td contenteditable="true" class="roleWage" onkeyup="javascript:itterateTable();">89298</td>
				  <td contenteditable="true" class="roleCount" onkeyup="javascript:itterateTable();">0</td>
				</tr>
				<tr class="role">
					<td contenteditable="true" class="roleName" onkeyup="javascript:itterateTable();">Product Owner</td>
					<td contenteditable="true" class="roleWage" onkeyup="javascript:itterateTable();">89441</td>
					<td contenteditable="true" class="roleCount" onkeyup="javascript:itterateTable();">0</td>
				</tr>
				<tr class="role">
					<td contenteditable="true" class="roleName" onkeyup="javascript:itterateTable();">Lead Software Engineer</td>
					<td contenteditable="true" class="roleWage" onkeyup="javascript:itterateTable();">137814</td>
					<td contenteditable="true" class="roleCount" onkeyup="javascript:itterateTable();">0</td>
				</tr>
				<tr class="role">
					<td contenteditable="true" class="roleName" onkeyup="javascript:itterateTable();">Engineering Manager</td>
					<td contenteditable="true" class="roleWage" onkeyup="javascript:itterateTable();">137166</td>
					<td contenteditable="true" class="roleCount" onkeyup="javascript:itterateTable();">0</td>
				</tr>
				<tr class="role">
					<td contenteditable="true" class="roleName" onkeyup="javascript:itterateTable();">Director of Engineering</td>
					<td contenteditable="true" class="roleWage" onkeyup="javascript:itterateTable();">133349</td>
					<td contenteditable="true" class="roleCount" onkeyup="javascript:itterateTable();">0</td>
				</tr>
			  </table>
			-->
			<div class="row">
				<div class="col pt-3">
					<input class="btn btn-primary" type="submit" value="Start meeting" onClick="startTicker()">
					<input class="btn btn-danger" type="submit" value="Reset" onClick="location.reload()"></p>
				</div>
			</div>
		</div>
	</body>
</html>